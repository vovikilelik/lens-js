<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
	<head>
		<title>TODO supply a title</title>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
	</head>
	<body>
		<div>TODO write content</div>
		<script type="module">
			import { Lens } from '../src/lens-js.js';
            import { createLens, Callback } from '../src/lens-utils.js';
			
			const lens = createLens({ one: {} });
			
			/*console.log('init', lens.get());
			
			const a = { one: { two: { moo: 'moo' }, two2: 'two2' }, one2: 'one2' };

			lens.attach((...args) => console.log('root', ...args));

			lens.go('one').go('two').go('moo').attach((...args) => console.log('moo', ...args));
			lens.go('one').go('two').attach((...args) => console.log('two', ...args));
			lens.go('one').go('two2').attach((...args) => console.log('two2', ...args));
			lens.go('one2').attach((...args) => console.log('one2', ...args));
			
			lens.go('one').attach(Callback.change((...args) => console.log('one: addChangeListener', ...args)));
			lens.go('one').go('two').attach(Callback.change((...args) => console.log('two: addChangeListener', ...args)));
			lens.go('one').go('two').go('moo').attach(Callback.change((...args) => console.log('moo: addChangeListener', ...args)));
			
			lens.set(a);
			
			console.log('== one2 ==');
			
			lens.go('one2').set('one2xxxx');
			
			console.log('== moo ==');
			
//			lens.go('one').go('two').go('moo').set('moo2');
			lens.go('one').go('two').set({ moo: 'moo', foo: 'foo' });
			console.log('== undefined ==');
			lens.go('one').go('two').set(undefined);
			console.log('== moo ==');
			lens.go('one').go('two').set({ moo: 'mooz', foo: 'foo' });*/
			
			lens.get(); // { one: {} }

			/* Объявим обработчик на существующее поле */
			const one = lens.go('one');
			one.attach(Callback.node(e => console.log('one', e.current)));

			/* Объявим обработчик на не существующую подветвь */
			const foo = one.go('foo');
			foo.attach(Callback.node(e => console.log('foo', e.current)));
			
			console.log('set Hello...');
			foo.set('Hello');
			
			console.log('set World...');
			foo.set('World');
		</script>	
	</body>
</html>
